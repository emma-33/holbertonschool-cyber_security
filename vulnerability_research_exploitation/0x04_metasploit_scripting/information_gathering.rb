#!/usr/bin/env ruby

class MetasploitModule < Msf::Post

  Rank = NormalRanking

    def initialize(info = {})
        super(update_info(info,
        'Name'     => 'information gathering script',
        'Description' => %q{
            The purpose of this script is to gather various pieces of information 
            from a target system once access is gained.
        },
        'Author'   => [ 'Emma LATEYRON' ],
        'License'  => MSF_LICENSE))
    end
      
    def run 
        print_status("Gathering system information from #{session_id}")

        gather_system_info
        gather_user_info
        gather_network_info
        gather_running_processes

    end

    def gather_system_info 
        sysinfo = session.sys.config.sysinfo
        print_good("OS: #{sysinfo['OS']}")
        print_good("Computer: #{sysinfo['Computer']}")
    end

    def gather_user_info
        user = session.sys.config.getuid
        print_good("User: #{user}")
    end

    def gather_network_info
        interfaces = session.net.config.interfaces
        interfaces.each { |interface|
        interface.addrs.each { |addr|
            print_good("Interface: #{interface.name}, IP: #{addr.addr}, Netmask: #{addr.netmask}, Broadcast: #{addr.broad}")
            }
        }
    end

    def gather_running_processes
        procs = session.sys.process.get_processes
        procs.each { |proc|
        print_good("Process #{proc['pid']} - #{proc['name']}")
       
    }
    end
end
